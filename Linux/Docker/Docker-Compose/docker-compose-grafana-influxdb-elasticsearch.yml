influxdb:
  image: influxdb:latest
  restart: always
  container_name: influxdb
  ports:
    - "8083:8083"
    - "8086:8086"
    - "8090:8090"
  env_file:
    - 'env.influxdb'
  volumes:
    # Data persistency
    # sudo mkdir -p /srv/docker/influxdb/data
    - /srv/docker/influxdb/data:/var/lib/influxdb

grafana:
  image: grafana/grafana:latest
  restart: always
  container_name: grafana
  ports:
    - "80:3000"
  env_file:
    - 'env.grafana'
  user: "0"
  links:
    - influxdb
  volumes:
    # Data persistency
    # sudo mkdir -p /srv/docker/grafana/data; chown 472:472 /srv/docker/grafana/data
    - /srv/docker/grafana/data:/var/lib/grafana
    
    
elasticsearch:
  image: docker.elastic.co/elasticsearch/elasticsearch:5.4.3
  restart: always
  container_name: elasticsearch
  ports:
    - "9200:9200"
  volumes:
    - elasticsearch_data:/usr/share/elasticsearch/data
    - ./elasticsearch.yml:/conf/elasticsearch.yml
  # logging:
  #   driver: none
  environment:
    - cluster.name=docker-cluster
    - bootstrap.memory_lock=true
    - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    - xpack.security.enabled=false
    - xpack.watcher.enabled=false
  ulimits:
    memlock:
      soft: -1
      hard: -1
  # deploy:
  #   resources:
  #     limits:
  #       memory: 1g
    